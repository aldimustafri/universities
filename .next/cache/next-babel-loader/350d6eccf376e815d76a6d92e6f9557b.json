{"ast":null,"code":"/**\n * @author Aldi Mustafri\n * @email aldimustafri@live.com\n * @create date 2020-09-20 23:52:23\n * @modify date 2020-09-20 23:52:23\n * @desc [description]\n */\nvar fs = require(\"fs\");\n\nvar dataApi = \"./data/users.json\";\n\nfunction readFile(callback, returnJson = false, filePath = dataApi, encoding = \"utf8\") {\n  fs.readFile(filePath, encoding, (err, data) => {\n    if (err) {\n      throw err;\n    }\n\n    callback(returnJson ? JSON.parse(data) : data);\n  });\n}\n\nfunction writeFile(fileData, callback, filePath = dataApi, encoding = \"utf8\") {\n  fs.writeFile(filePath, fileData, encoding, err => {\n    if (err) {\n      throw err;\n    }\n\n    callback();\n  });\n}\n\nexport default (async (req, res) => {\n  const newUser = {\n    name: await req.body.name,\n    email: await req.body.email,\n    address: await req.body.address\n  };\n\n  try {\n    readFile(data => {\n      const newUserId = Object.keys(data).length + 1;\n      data[newUserId.toString()] = newUser;\n      writeFile(JSON.stringify(data, null, 2), () => {\n        res.status(200).send(\"new user added\");\n      });\n    }, true);\n  } catch (error) {\n    console.log(error);\n  }\n});","map":null,"metadata":{},"sourceType":"module"}